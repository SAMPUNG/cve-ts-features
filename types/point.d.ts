import type { Coordinates, CustomParams, Offset } from './common'
import type { FeatureData } from './feature'

export interface Marker01Params {
  /**
   * 颜色
   *
   * 16进制 RGBA 值（如“#FF0000FF”），或标准 RGBA 值（如“rgba(255,0,0,0.5)”）
   */
  Color: string
  /** 弹跳周期（秒）, 建议值为 [0-n) */
  DurationPerBounce: number
  /** 自发光强度，建议值为 (1,100] */
  Emissive: number
  /** 弹跳高度（米）, 建议值为 [0-n) */
  HeightPerBounce: number
  /** 每秒旋转度数（度）, 建议值为 [0-n) */
  RotationPerSecond: number
}

export interface Marker02Params {
  /** 波纹个数, 建议值为 [0-n) */
  CircleAmount: number
  /**
   * 颜色
   *
   * 16进制 RGBA 值（如“#FF0000FF”），或标准 RGBA 值（如“rgba(255,0,0,0.5)”）
   */
  Color: string
  /** 周期持续时间, 建议值为 (0-n) */
  Duration: number
  /** 自发光强度，建议值为 (1, 100] */
  Emissive: number
  /** 直径大小（米）, 建议值为 (0,n) */
  Size: number
}

export interface Label01Params {
  /** 图片结束淡化（消失）的距离（米），建议值为 (0,n) */
  FadeEndDistance: number
  /** 图片开始淡化的距离（米），建议值为 (0,n) */
  FadeStartDistance: number
  /** 标签文字大小，默认值为 24，建议值为 (0,n) */
  FontSize: number
  /**
   * 图标背景色
   *
   * 16进制 RGBA 值（如“#FF0000FF”），或标准 RGBA 值（如“rgba(255,0,0,0.5)”）
   */
  ImageBackgroundColor: string
  /**
   * 图标默认图片，有三种模式：
   *
   * 1、图片 url，字符串必须以“http”开头；
   *
   * 2、图片 base64 编码，字符串必须以“data:”开头；
   *
   * 3、约定好的虚幻引擎图片资源名称。
   *
   * 不设置该属性则为默认样式
   */
  ImageNormal: string
  /**
   * 图标大小，默认值为 64
   *
   * [number，number]
   */
  ImageSize: [sizeX: number, sizeY: number]
  /** 点击 POI 点后摄像机到 POI 点的距离（米），建议值为 (0,n) */
  TargetLength: number
}

export interface Label02Params {
  /** 图片结束淡化（消失）的距离（米），建议值为 (0,n) */
  FadeEndDistance: number
  /** 图片开始淡化的距离（米），建议值为 (0,n) */
  FadeStartDistance: number
  /** 标签文字大小，默认值为 24，建议值为 (0,n) */
  FontSize: number
  /**
   * 图标处于 Hover 状态时图片资源字符串，有三种模式：
   *
   * 1、图片 url，字符串必须以“http”开头；
   *
   * 2、图片 base64 编码，字符串必须以“data:”开头；
   *
   * 3、约定好的虚幻引擎图片资源名称。
   *
   * 不设置该属性则为默认样式
   */
  ImageHover: string
  /**
   * 图标默认图片，有三种模式：
   *
   * 1、图片 url，字符串必须以“http”开头；
   *
   * 2、图片 base64 编码，字符串必须以“data:”开头；
   *
   * 3、约定好的虚幻引擎图片资源名称。
   *
   * 不设置该属性则为默认样式
   */
  ImageNormal: string
  /**
   * 图标大小，默认值为 64
   *
   * [number，number]
   */
  ImageSize: [sizeX: number, sizeY: number]
  /** 点击 POI 点后摄像机到 POI 点的距离（米），建议值为 (0,n) */
  TargetLength: number
}

export interface Label03Params {
  /** 图片结束淡化（消失）的距离（米），建议值为 (0,n) */
  FadeEndDistance: number
  /** 图片开始淡化的距离（米），建议值为 (0,n) */
  FadeStartDistance: number
  /** 标签文字大小，默认值为 24，建议值为 (0,n) */
  FontSize: number
  /**
   * 图标处于 Hover 状态时图片资源字符串，有三种模式：
   *
   * 1、图片 url，字符串必须以“http”开头；
   *
   * 2、图片 base64 编码，字符串必须以“data:”开头；
   *
   * 3、约定好的虚幻引擎图片资源名称。
   *
   * 不设置该属性则为默认样式
   */
  ImageHover: string
  /**
   * 图标默认图片，有三种模式：
   *
   * 1、图片 url，字符串必须以“http”开头；
   *
   * 2、图片 base64 编码，字符串必须以“data:”开头；
   *
   * 3、约定好的虚幻引擎图片资源名称。
   *
   * 不设置该属性则为默认样式
   */
  ImageNormal: string
  /** 指示标签宽度是否固定，默认值为 false */
  IsFixedLabelWidth: boolean
  /**
   * 标签宽度
   *
   * IsFixedLabelWidth 为 true 时生效
   *
   * 默认值为 120
   *
   * 建议值为 (0,n)
   */
  LabelWidth: number
  /** 点击 POI 点后摄像机到 POI 点的距离（米），建议值为 (0,n) */
  TargetLength: number
}

/** 点数据 */
export class PointData<T extends PointStyle> extends FeatureData {
  /**
   * [longitude, latitude, altitude]
   *
   * 若未指定 altitude 值，则取默认值 0。
   *
   * 当未指定 altitude 值时，建议将参数 isHeightBasedSurface 设置为 true，并结合参数 offset 使用
   */
  declare Coordinates: Coordinates
  /**
   * 指示 Feature 生成时，其高度是否基于场景上表面
   *
   * 若为 true，则高度为各点平面坐标处与场景上表面的交点加上 offset 参数的 z 值
   */
  declare IsHeightBasedSurface: boolean
  /** [x, y, z] 基于坐标的偏移量（米），其中 z 值代表绘制的平面所处高度 */
  declare Offset: Offset
  /** 'Custom' | 'Marker01' | 'Marker02' | 'Label01' | 'Label02' | 'Label03' */
  declare Style: T

  /**
   * Point Data Constructor
   * - 若 coordinates 未指定 altitude 值，则取默认值 0。
   * - 当 coordinates 未指定 altitude 值时，建议将参数 isHeightBasedSurface 设置为 true，并结合参数 offset 使用
   * - 若 isHeightBasedSurface 为 true，则高度为各点平面坐标处与场景上表面的交点加上 offset 参数的 z 值
   * @param style POI 点样式
   * @param id
   * @param name
   * @param tag
   * @param coordinates [ longitude, latitude, altitude ]
   * @param offset [x, y, z] 基于坐标的偏移量（米），其中 z 值代表绘制的平面所处高度
   * @param isHeightBasedSurface 指示 Feature 生成时，其高度是否基于场景上表面
   * @param params 其他参数
   */
  constructor(
    style: T,
    id: string,
    name: string,
    tag: string,
    coordinates: Coordinates,
    offset: Offset,
    isHeightBasedSurface: boolean,
    params: PointParamsMap[T]
  )
}

export interface PointParamsMap {
  Custom: CustomParams
  Marker01: Marker01Params
  Marker02: Marker02Params
  Label01: Label01Params
  Label02: Label02Params
  Label03: Label03Params
}

export type PointStyle =
  | 'Custom'
  | 'Marker01'
  | 'Marker02'
  | 'Label01'
  | 'Label02'
  | 'Label03'

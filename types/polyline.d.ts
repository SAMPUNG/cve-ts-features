import type { CustomParams } from 'types/feature'

export interface Arrow01Params {
  /** Polyline 创建后的显示动画 */
  Animate: PolylineAnimate
  /** 动画速度（米/秒），建议值为 (0, n) */
  AnimateSpeed: number
  /** 动画持续时间，建议值为 (0, n) */
  AnimateDuration: number
  /**
   * 颜色
   *
   * 16进制 RGBA 值（如“#FF0000FF”），或标准 RGBA 值（如“rgba(255,0,0,0.5)”）
   */
  Color: string
  /** 流动速度，0 时不动，负值时反方向，建议值为 n */
  FlowSpeed: number
  /** 浮于表面生成时的插值计算距离（米），建议值为 (0,n) */
  InterpolationDistance: number
  /** 是否首位相连，默认为 false */
  IsLoop: boolean
  /** 平滑度，值越小 Polyline 越平滑，但性能越差，默认值为 100，建议值为 (0, n) */
  Smoothness: number
  /** 宽度（米），建议值为 (0, n) */
  Width: number
}

export interface Dash01Params {
  /** Polyline 创建后的显示动画 */
  Animate: PolylineAnimate
  /** 动画速度（米/秒），建议值为 (0, n) */
  AnimateSpeed: number
  /** 动画持续时间，建议值为 (0, n) */
  AnimateDuration: number
  /**
   * 颜色
   *
   * 16进制 RGBA 值（如“#FF0000FF”），或标准 RGBA 值（如“rgba(255,0,0,0.5)”）
   */
  Color: string
  /**
   * 颜色2
   *
   * 16进制 RGBA 值（如“#FF0000FF”），或标准 RGBA 值（如“rgba(255,0,0,0.5)”）
   */
  Color2: string
  /** 流动速度，0 时不动，负值时反方向，建议值为 n */
  FlowSpeed: number
  /** 浮于表面生成时的插值计算距离（米），建议值为 (0,n) */
  InterpolationDistance: number
  /** 是否首位相连，默认为 false */
  IsLoop: boolean
  /** 虚实比例，默认为 (0, n) */
  Ratio: number
  /** 长度缩放系数，贴图缩放比例，默认为 (0, n) */
  Scale: number
  /** 平滑度，值越小 Polyline 越平滑，但性能越差，默认值为 100，建议值为 (0, n) */
  Smoothness: number
  /** 宽度（米），建议值为 (0, n) */
  Width: number
}

export interface Gradient01Params {
  /** Polyline 创建后的显示动画 */
  Animate: PolylineAnimate
  /** 动画速度（米/秒），建议值为 (0, n) */
  AnimateSpeed: number
  /** 动画持续时间，建议值为 (0, n) */
  AnimateDuration: number
  /**
   * 颜色
   *
   * 16进制 RGBA 值（如“#FF0000FF”），或标准 RGBA 值（如“rgba(255,0,0,0.5)”）
   */
  Color: string
  /** 指示 Polyline 是水平还是直立 */
  Direction: PolylineDirection
  /** 浮于表面生成时的插值计算距离（米），建议值为 (0,n) */
  InterpolationDistance: number
  /** 是否首位相连，默认为 false */
  IsLoop: boolean
  /** 平滑度，值越小 Polyline 越平滑，但性能越差，默认值为 100，建议值为 (0, n) */
  Smoothness: number
  /** 宽度（米），建议值为 (0, n) */
  Width: number
}

export interface OD01Params {
  /** Polyline 创建后的显示动画 */
  Animate: PolylineAnimate
  /** 动画速度（米/秒），建议值为 (0, n) */
  AnimateSpeed: number
  /** 动画持续时间，建议值为 (0, n) */
  AnimateDuration: number
  /**
   * 颜色
   *
   * 16进制 RGBA 值（如“#FF0000FF”），或标准 RGBA 值（如“rgba(255,0,0,0.5)”）
   */
  Color: string
  /**
   * 颜色2
   *
   * 16进制 RGBA 值（如“#FF0000FF”），或标准 RGBA 值（如“rgba(255,0,0,0.5)”）
   */
  Color2: string
  /** 曲率，建议值为 (0, n) */
  Curvature: number
}

export interface OD02Params {
  /** Polyline 创建后的显示动画 */
  Animate: PolylineAnimate
  /** 动画速度（米/秒），建议值为 (0, n) */
  AnimateSpeed: number
  /** 动画持续时间，建议值为 (0, n) */
  AnimateDuration: number
  /**
   * 颜色
   *
   * 16进制 RGBA 值（如“#FF0000FF”），或标准 RGBA 值（如“rgba(255,0,0,0.5)”）
   */
  Color: string
  /** 曲率，建议值为 (0, n) */
  Curvature: number
}

export type PolylineAnimate =
  | 'Immediately'
  | 'StartToEnd'
  | 'EndToStart'
  | 'MiddleToSide'

/** 线数据 */
export class PolylineData<T extends PolylineStyle> extends FeatureData {
  /**
   * [longitude, latitude, altitude][]
   *
   * 若未指定 altitude 值，则取默认值 0。
   *
   * 当未指定 altitude 值时，建议将参数 isHeightBasedSurface 设置为 true，并结合参数 offset 使用
   */
  declare Coordinates: Coordinates[]
  /**
   * 指示 Feature 生成时，其高度是否基于场景上表面
   *
   * 若为 true，则高度为各点平面坐标处与场景上表面的交点加上 offset 参数的 z 值
   */
  declare IsHeightBasedSurface: boolean
  /**
   * 指示 Polyline 生成时，两点之间的连线是否沿着于地表
   *
   * 若为 true，且 IsHeightBasedSurface 为 true，生成的线将以 offset 参数的 z 值高度紧贴地表
   *
   * 插值间隔在 params 参数中的 InterpolationDistance 设置，默认为 1 米
   */
  declare IsTraceSurface: boolean
  /** [x, y, z] 基于坐标的偏移量（米），其中 z 值代表绘制的平面所处高度 */
  declare Offset: Offset
  /** 'Arrow01' | 'Custom' | 'Dash01' | 'Gradient01' | 'OD01' | 'OD02' | 'Solid01 */
  declare Style: T

  /**
   * Polyline Data Constructor
   * - 若 coordinates 未指定 altitude 值，则取默认值 0。
   * - 当 coordinates 未指定 altitude 值时，建议将参数 isHeightBasedSurface 设置为 true，并结合参数 offset 使用
   * - 若 isHeightBasedSurface 为 true，则高度为各点平面坐标处与场景上表面的交点加上 offset 参数的 z 值
   * - 若 isTraceSurface 为 true，且 IsHeightBasedSurface 为 true，生成的线将以 offset 参数的 z 值高度紧贴地表，插值间隔在 params 参数中的 InterpolationDistance 设置，默认为 1 米
   * @param style Polyline 样式
   * @param id
   * @param name
   * @param tag
   * @param coordinates [ longitude, latitude, altitude ]
   * @param offset [x, y, z] 基于坐标的偏移量（米），其中 z 值代表绘制的平面所处高度
   * @param isHeightBasedSurface 指示 Feature 生成时，其高度是否基于场景上表面
   * @param isTraceSurface 指示 Polyline 生成时，两点之间的连线是否沿着于地表
   * @param params 其他参数
   */
  constructor(
    style: T,
    id: string,
    name: string,
    tag: string,
    coordinates: Coordinates[],
    offset: Offset,
    isHeightBasedSurface: boolean,
    isTraceSurface: boolean,
    params: PolylineParamsMap[T]
  )
}

export type PolylineDirection = 'Horizontal' | 'Vertical'

export interface PolylineParamsMap {
  Arrow01: Arrow01Params
  Custom: CustomParams
  Dash01: Dash01Params
  Gradient01: Gradient01Params
  OD01: OD01Params
  OD02: OD02Params
  Solid01: Solid01Params
}

export type PolylineStyle =
  | 'Arrow01'
  | 'Custom'
  | 'Dash01'
  | 'Gradient01'
  | 'OD01'
  | 'OD02'
  | 'Solid01'

export interface Solid01Params {
  /** Polyline 创建后的显示动画 */
  Animate: PolylineAnimate
  /** 动画速度（米/秒），建议值为 (0, n) */
  AnimateSpeed: number
  /** 动画持续时间，建议值为 (0, n) */
  AnimateDuration: number
  /**
   * 颜色
   *
   * 16进制 RGBA 值（如“#FF0000FF”），或标准 RGBA 值（如“rgba(255,0,0,0.5)”）
   */
  Color: string
  /** 浮于表面生成时的插值计算距离（米），建议值为 (0,n) */
  InterpolationDistance: number
  /** 是否首位相连，默认为 false */
  IsLoop: boolean
  /** 平滑度，值越小 Polyline 越平滑，但性能越差，默认值为 100，建议值为 (0, n) */
  Smoothness: number
  /** 宽度（米），建议值为 (0, n) */
  Width: number
}

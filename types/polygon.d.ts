import type { Coordinates, CustomParams, Offset } from './common'
import type { FeatureData } from './feature'

export interface Solid01Params {
  /**
   * 颜色
   *
   * 16进制 RGBA 值（如“#FF0000FF”），或标准 RGBA 值（如“rgba(255,0,0,0.5)”）
   */
  Color: string
  /** 自发光强度，建议值为 (1,100] */
  Emissive: number
}

export interface Stripe01Params {
  /** 条纹角度（度），建议值为 [0,360] */
  Angle: number
  /**
   * 颜色1
   *
   * 16进制 RGBA 值（如“#FF0000FF”），或标准 RGBA 值（如“rgba(255,0,0,0.5)”）
   */
  Color: string
  /**
   * 颜色2
   *
   * 16进制 RGBA 值（如“#FF0000FF”），或标准 RGBA 值（如“rgba(255,0,0,0.5)”）
   */
  Color2: string
  /** 自发光强度，建议值为 (1,100] */
  Emissive: number
  /** 条纹间线宽比例，建议值为 (0,n) */
  Ratio: number
  /** 条纹宽度缩放系数，建议值为 (0,n) */
  Scale: number
  /** 流动速度，0时不动，负值时反方向 */
  Speed: number
}

/** 面数据 */
export class PolygonData<T extends PolygonStyle> extends FeatureData {
  /**
   * [longitude, latitude, altitude][]
   *
   * 若未指定 altitude 值，则取默认值 0。
   *
   * 当未指定 altitude 值时，建议将参数 isHeightBasedSurface 设置为 true，并结合参数 offset 使用
   */
  declare Coordinates: Coordinates[]
  /**
   * 指示 Feature 生成时，其高度是否基于场景上表面
   *
   * 若为 true，则高度为各点平面坐标处与场景上表面的交点加上 offset 参数的 z 值
   */
  declare IsHeightBasedSurface: boolean
  /** [x, y, z] 基于坐标的偏移量（米），其中 z 值代表绘制的平面所处高度 */
  declare Offset: Offset
  /** 'Custom' | 'Solid01' | 'Stripe01' */
  declare Style: T

  /**
   * Polygon Data Constructor
   * - 若 coordinates 未指定 altitude 值，则取默认值 0。
   * - 当 coordinates 未指定 altitude 值时，建议将参数 isHeightBasedSurface 设置为 true，并结合参数 offset 使用
   * - 若 isHeightBasedSurface 为 true，则高度为各点平面坐标处与场景上表面的交点加上 offset 参数的 z 值
   * @param style POI 点样式
   * @param id
   * @param name
   * @param tag
   * @param coordinates [ longitude, latitude, altitude ][]
   * @param offset [x, y, z] 基于坐标的偏移量（米），其中 z 值代表绘制的平面所处高度
   * @param isHeightBasedSurface 指示 Feature 生成时，其高度是否基于场景上表面
   * @param params 其他参数
   */
  constructor(
    style: T,
    id: string,
    name: string,
    tag: string,
    coordinates: Coordinates[],
    offset: Offset,
    isHeightBasedSurface: boolean,
    params: PolygonParamsMap[T]
  ) {
    super(style, id, name, tag, params)
    this.Coordinates = coordinates
    this.Offset = offset
    this.IsHeightBasedSurface = isHeightBasedSurface
  }
}

export interface PolygonParamsMap {
  Custom: CustomParams
  Solid01: Solid01Params
  Stripe01: Stripe01Params
}

export type PolygonStyle = 'Custom' | 'Solid01' | 'Stripe01'
